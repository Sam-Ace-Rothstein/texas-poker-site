/* empty css                 */import{Connection as u,Transaction as p,SystemProgram as f}from"https://cdn.skypack.dev/@solana/web3.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(e){if(e.ep)return;e.ep=!0;const t=o(e);fetch(e.href,t)}})();const m=new URLSearchParams(window.location.search),d=m.get("username")||"",l=m.get("handle")||"";document.getElementById("tgId").textContent=d||"unknown";document.getElementById("tgHandle").textContent=l||"Player";const c=document.getElementById("connectWallet"),y=document.getElementById("walletAddr");c.disabled=!1;let a;c.addEventListener("click",async()=>{var o;if(!((o=window.solana)!=null&&o.isPhantom))return alert("Please install Phantom Wallet");a=window.solana;const n=(await a.connect()).publicKey.toString();y.textContent=`Wallet: ${n}`,c.disabled=!0,await fetch("/api/registerWallet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tgId:d,tgHandle:l,pubkey:n})}),document.getElementById("depositForm").style.display="block"});document.getElementById("sendDeposit").addEventListener("click",async()=>{const r=parseFloat(document.getElementById("solAmt").value);if(!r||r<=0)return alert("Enter a valid SOL amount");const n=r*1e9,o=new u("https://api.mainnet-beta.solana.com"),s=new p().add(f.transfer({fromPubkey:a.publicKey,toPubkey:"<YOUR_HOUSE_WALLET_PUBKEY>",lamports:n})),e=await a.signTransaction(s),t=await o.sendRawTransaction(e.serialize());document.getElementById("depositStatus").textContent="Sending…",await o.confirmTransaction(t),document.getElementById("depositStatus").textContent=`✅ Deposit sent! Tx: ${t}`,await fetch("/api/creditUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tgId:d,tgHandle:l,lamports:n})})});
